<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/computer_file/program/minesweeper - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/computer_file/program/minesweeper.html#var">Var Details</a> - <a href="datum/computer_file/program/minesweeper.html#proc">Proc Details</a></header><main><h1>minesweeper <aside>/<a href="datum.html">datum</a>/<a href="datum/computer_file.html">computer_file</a>/<a href="datum/computer_file/program.html">program</a>/<a href="datum/computer_file/program/minesweeper.html">minesweeper</a></aside> <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L19"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 19"></a></h1><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#var/bomb_cells">bomb_cells</a></th><td>Cells with bombs. Used in <code>reveal_all_bombs</code></td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#var/current_3BV">current_3BV</a></th><td>Current field 3BV (special system of score for minesweeper). Used to calculate 3BV/s (user efficiency)</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#var/directions">directions</a></th><td>Directions for adjacent cells</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#var/field_bombs_amount">field_bombs_amount</a></th><td>Current field amount of bombs</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#var/field_height">field_height</a></th><td>Current field amount of rows</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#var/field_width">field_width</a></th><td>Current field amount of columns</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#var/first_touch">first_touch</a></th><td>Thing, to make first touch safety</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#var/flagged_bombs">flagged_bombs</a></th><td>Amount of flagged bombs. Used to check win condition</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#var/glob_leaderboard">glob_leaderboard</a></th><td>The global leaderboard list</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#var/ignore_touches">ignore_touches</a></th><td>Decision to make interface untouchable in the momemnt of regenerating</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#var/leaderboard">leaderboard</a></th><td>The current round leaderboard list</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#var/loose_explosion_range_heavy">loose_explosion_range_heavy</a></th><td>Emagged bomb stats</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#var/minesweeper_matrix">minesweeper_matrix</a></th><td>Here we have all the minesweeper info</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#var/opened_cells">opened_cells</a></th><td>Amount of opened cells. Used to check win condition</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#var/set_flags">set_flags</a></th><td>Amount of set flags. Used to check win condition</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#var/start_time">start_time</a></th><td>The world.time the game was started. Used to calculate 3BV/s (user efficiency)</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#proc/add_into_leaders">add_into_leaders</a></th><td>Add player result to local, global leaderboards and DB</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#proc/add_result_to_db">add_result_to_db</a></th><td>Insert new player result into database</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#proc/change_field_params">change_field_params</a></th><td>Requests user the new field params and updates the field</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#proc/count_3BV">count_3BV</a></th><td>Count value of field for scoring</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#proc/generate_field">generate_field</a></th><td>Fill matrix with bombs, ignores 3x3 square around first touch place</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#proc/handle_square_click">handle_square_click</a></th><td>Handles a click on a square on the field.</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#proc/init_leaderboard">init_leaderboard</a></th><td>Get stored in database player results and fill glob_leaderboard with them</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#proc/is_cell_in_bounds">is_cell_in_bounds</a></th><td>Checks if cell by passed coordinates is in field bounds</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#proc/make_empty_matrix">make_empty_matrix</a></th><td>Return the minesweeper matrix to initial state</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#proc/mark_adjacent_zeros">mark_adjacent_zeros</a></th><td>part of proc/count_3BV, used to ignore adjacent &quot;zeroes&quot;</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#proc/on_loose">on_loose</a></th><td>Called when player lost the game</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#proc/open_cell">open_cell</a></th><td>Makes cell by passed coordinates open.
Increases <code>opened_cells</code> if cell was successfully opened and removes flag from it.</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#proc/reveal_all_bombs">reveal_all_bombs</a></th><td>Makes all cells with bombs open. Used in <code>on_loose</code> proc</td></tr><tr><th><a href="datum/computer_file/program/minesweeper.html#proc/update_zeros">update_zeros</a></th><td>Open all &quot;zeroes&quot; around the click place</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/bomb_cells"><aside class="declaration">var </aside>bomb_cells <aside>– /list</aside> <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L61"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 61"></a></h3><p>Cells with bombs. Used in <code>reveal_all_bombs</code></p><h3 id="var/current_3BV"><aside class="declaration">var </aside>current_3BV <aside>– </aside> <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L50"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 50"></a></h3><p>Current field 3BV (special system of score for minesweeper). Used to calculate 3BV/s (user efficiency)</p><h3 id="var/directions"><aside class="declaration">var </aside>directions <aside>– /static/list</aside> <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L71"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 71"></a></h3><p>Directions for adjacent cells</p><h3 id="var/field_bombs_amount"><aside class="declaration">var </aside>field_bombs_amount <aside>– </aside> <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L48"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 48"></a></h3><p>Current field amount of bombs</p><h3 id="var/field_height"><aside class="declaration">var </aside>field_height <aside>– </aside> <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L44"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 44"></a></h3><p>Current field amount of rows</p><h3 id="var/field_width"><aside class="declaration">var </aside>field_width <aside>– </aside> <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L46"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 46"></a></h3><p>Current field amount of columns</p><h3 id="var/first_touch"><aside class="declaration">var </aside>first_touch <aside>– </aside> <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L32"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 32"></a></h3><p>Thing, to make first touch safety</p><h3 id="var/flagged_bombs"><aside class="declaration">var </aside>flagged_bombs <aside>– </aside> <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L37"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 37"></a></h3><p>Amount of flagged bombs. Used to check win condition</p><h3 id="var/glob_leaderboard"><aside class="declaration">var </aside>glob_leaderboard <aside>– /static/list</aside> <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L67"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 67"></a></h3><p>The global leaderboard list</p><h3 id="var/ignore_touches"><aside class="declaration">var </aside>ignore_touches <aside>– </aside> <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L42"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 42"></a></h3><p>Decision to make interface untouchable in the momemnt of regenerating</p><h3 id="var/leaderboard"><aside class="declaration">var </aside>leaderboard <aside>– /static/list</aside> <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L69"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 69"></a></h3><p>The current round leaderboard list</p><h3 id="var/loose_explosion_range_heavy"><aside class="declaration">var </aside>loose_explosion_range_heavy <aside>– </aside> <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L55"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 55"></a></h3><p>Emagged bomb stats</p><h3 id="var/minesweeper_matrix"><aside class="declaration">var </aside>minesweeper_matrix <aside>– /list</aside> <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L64"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 64"></a></h3><p>Here we have all the minesweeper info</p><h3 id="var/opened_cells"><aside class="declaration">var </aside>opened_cells <aside>– </aside> <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L39"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 39"></a></h3><p>Amount of opened cells. Used to check win condition</p><h3 id="var/set_flags"><aside class="declaration">var </aside>set_flags <aside>– </aside> <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L35"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 35"></a></h3><p>Amount of set flags. Used to check win condition</p><h3 id="var/start_time"><aside class="declaration">var </aside>start_time <aside>– </aside> <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L52"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 52"></a></h3><p>The world.time the game was started. Used to calculate 3BV/s (user efficiency)</p><h2 id="proc">Proc Details</h2><h3 id="proc/add_into_leaders"><aside class="declaration">proc </aside>add_into_leaders<aside>(/<a href="mob.html">mob</a>/user, game_time)  <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L235"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 235"></a></aside></h3><p>Add player result to local, global leaderboards and DB</p><h3 id="proc/add_result_to_db"><aside class="declaration">proc </aside>add_result_to_db<aside>(/list/new_result, ckey, width, height, bombs)  <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L262"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 262"></a></aside></h3><p>Insert new player result into database</p><h3 id="proc/change_field_params"><aside class="declaration">proc </aside>change_field_params<aside>(/<a href="mob.html">mob</a>/user)  <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L177"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 177"></a></aside></h3><p>Requests user the new field params and updates the field</p><h3 id="proc/count_3BV"><aside class="declaration">proc </aside>count_3BV<aside>()  <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L430"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 430"></a></aside></h3><p>Count value of field for scoring</p><h3 id="proc/generate_field"><aside class="declaration">proc </aside>generate_field<aside>(start_x, start_y)  <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L334"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 334"></a></aside></h3><p>Fill matrix with bombs, ignores 3x3 square around first touch place</p><h3 id="proc/handle_square_click"><aside class="declaration">proc </aside>handle_square_click<aside>(x, y, mode, /<a href="mob.html">mob</a>/user)  <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L131"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 131"></a></aside></h3><p>Handles a click on a square on the field.</p>
<p>@param {number} x - Row of the square
@param {number} y - Column of the square
@param {string} mode - The mode of the click. Can be &quot;bomb&quot; or &quot;flag&quot;
@param {mob} user - Mob that made the click</p>
<p>@return {boolean} - TRUE if the click was handled successfully, FALSE otherwise</p><h3 id="proc/init_leaderboard"><aside class="declaration">proc </aside>init_leaderboard<aside>()  <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L482"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 482"></a></aside></h3><p>Get stored in database player results and fill glob_leaderboard with them</p><h3 id="proc/is_cell_in_bounds"><aside class="declaration">proc </aside>is_cell_in_bounds<aside>(cell_x, cell_y)  <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L476"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 476"></a></aside></h3><p>Checks if cell by passed coordinates is in field bounds</p><h3 id="proc/make_empty_matrix"><aside class="declaration">proc </aside>make_empty_matrix<aside>()  <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L310"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 310"></a></aside></h3><p>Return the minesweeper matrix to initial state</p><h3 id="proc/mark_adjacent_zeros"><aside class="declaration">proc </aside>mark_adjacent_zeros<aside>(start_x, start_y)  <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L451"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 451"></a></aside></h3><p>part of proc/count_3BV, used to ignore adjacent &quot;zeroes&quot;</p><h3 id="proc/on_loose"><aside class="declaration">proc </aside>on_loose<aside>(final_bomb_x, final_bomb_y)  <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L283"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 283"></a></aside></h3><p>Called when player lost the game</p><h3 id="proc/open_cell"><aside class="declaration">proc </aside>open_cell<aside>(x, y)  <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L408"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 408"></a></aside></h3><p>Makes cell by passed coordinates open.
Increases <code>opened_cells</code> if cell was successfully opened and removes flag from it.</p>
<p>@param {number] x - The row of the cell
@param {number] y - The column of the cell</p>
<p>@return {boolean} - TRUE if cell should cause recursive opening, FALSE otherwise</p><h3 id="proc/reveal_all_bombs"><aside class="declaration">proc </aside>reveal_all_bombs<aside>()  <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L303"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 303"></a></aside></h3><p>Makes all cells with bombs open. Used in <code>on_loose</code> proc</p><h3 id="proc/update_zeros"><aside class="declaration">proc </aside>update_zeros<aside>(x, y)  <a href="https://github.com/ss220club/BandaStation/blob/370bfa7a277566ef0920daf9b6a994b077653d75/modular_bandastation/minesweeper/code/minesweeper.dm#L377"><img src="git.png" width="16" height="16" title="modular_bandastation/minesweeper/code/minesweeper.dm 377"></a></aside></h3><p>Open all &quot;zeroes&quot; around the click place</p></main><footer>tgstation.dme <a href="https://github.com/ss220club/BandaStation/tree/370bfa7a277566ef0920daf9b6a994b077653d75">370bfa7</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.9.0</a></footer></body></html>